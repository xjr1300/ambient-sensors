# 胡蝶蘭生育環境モニタリングシステム

## 使用しているセンサー

| センサー                                                           | 測定項目   | 動作電圧    | I2C |
| ------------------------------------------------------------------ | ---------- | ----------- | --- |
| SFE-SEN-13763 Si7021搭載 温湿度センサモジュール                    | 温度、湿度 | 1.9V - 3.6V | ○   |
| SSCI-027700 Conta™ 照度・近接一体型センサモジュール RPR-0521RS搭載 | 照度       | 2.8V - 3.6V | ○   |
| SFE-SEN-17731 Qwiic - 土壌水分量センサー                           | 土壌水分量 | 3.3V - 5.0V | ○   |

## ロジックレベル変換ボード

上記3つのセンサーは、3.3Vで動作するため、以下に示すロジック変換ボードを使用して、`Arduino`の5.0V信号をを使用して3.3Vに変換する。

* SFE-BOB-15439 PCA9306搭載 ロジックレベル変換ボード

## I2C

上記3つのセンサーは、`I2C`接続に対応しているため、ケーブルを取り扱いする煩雑さを低減するために、すべて`I2C`接続する。

## 測定値の表示

測定値は、LCD（`LCD1602`）に表示する。
なお、可変抵抗器の`ツマミ`を左右に動かすことで、LCDの光量を変更できる。

## Qwiic接続システム

土壌水分センサーは、`SparkFun`社の`Qwiic`接続システムで`I2C`接続する。
`Qwiic`ケーブルは、以下の通り接続する。

| ケーブルの色 | 接続先   |
| ------------ | -------- |
| 黒色         | グランド |
| 赤色         | 3.3V     |
| 青色         | `SDA`    |
| 黄色         | `SCL`    |

## 土壌水分量

`SparkFun`社の土壌水分センサーの[サンプル](https://github.com/sparkfun/Zio-Qwiic-Soil-Moisture-Sensor)を参照して実装したが、以下の測定値（計算結果）が得られ、`SparkFun`社の[Hookup Guide](https://learn.sparkfun.com/tutorials/soil-moisture-sensor-hookup-guide?_ga=2.138745008.263601631.1645400632-430733852.1643589927)に示された測定値（計算結果）が得られなかった。

| 状態   | 値     |
| ------ | ------ |
| 空気中 | 1023   |
| 水中   | 20程度 |

よって、以下の通り土壌水分量を0から100の値に換算して、LCDに表示する。
ここで、以下の`acd_value`は、上記サンプルが測定値（計算結果）としている値である。

```c++
(int)((double)(1023 - adc_value) / 1023 * 100);
```
